<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>주문 내역 | Persome</title>
    <style>
        .order-container{border:1px solid #eee;border-radius:12px;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,0.04);padding:20px}
        .order-container h2{margin:0 0 16px;font-size:18px;font-weight:700;color:#222;border-bottom:1px solid #f0f0f0;padding-bottom:8px}
        .order-container table{width:100%;border-collapse:collapse;font-size:14px}
        .order-container th,.order-container td{padding:14px 14px;border-bottom:1px solid #f7f7f7;text-align:center}
        .order-container th{background:#fafafa;font-weight:600;color:#333}
        .order-container .btn-detail{padding:6px 12px;background-color:#A68DC0;color:#fff;border-radius:6px;font-size:13px;text-decoration:none;transition:0.2s}
        .order-container .btn-detail:hover{background-color:#8b73a5}
        .order-container .empty{text-align:center;padding:20px;color:#777;font-size:14px}
        .pagination{margin-top:16px;text-align:center}
        .pagination button{margin:0 3px;padding:6px 12px;border:1px solid #ddd;background:#fff;border-radius:6px;cursor:pointer;font-size:13px}
        .pagination button.active{background:#A68DC0;color:#fff;border-color:#A68DC0}
        .pagination button:disabled{color:#aaa;cursor:not-allowed;background:#f5f5f5}
        body{font-family:"Noto Sans KR",Arial,sans-serif;margin:0;background:#fff}
        .container{max-width:1100px;margin:20px auto;padding:0 16px}
        .grid{display:grid;grid-template-columns:260px 1fr;gap:24px;margin-top:18px}

        /* 주문/배송 상태 플로우 */
        .order-status{display:flex;justify-content:space-between;align-items:center;background:#fafafa;border:1px solid #eee;border-radius:12px;padding:20px;gap:10px;margin-bottom:16px}
        .order-step{flex:1;text-align:center;position:relative}
        .order-step strong{display:block;font-size:20px;font-weight:700;color:#A68DC0;margin-bottom:6px}
        .order-step span{font-size:13px;color:#555}
        .order-step::after{content:"›";position:absolute;right:-12px;top:50%;transform:translateY(-50%);color:#ccc;font-size:20px;font-weight:700}
        .order-step:last-child::after{display:none}

        .filter{margin-bottom:16px;text-align:right}
        .period-buttons{display:inline-flex;gap:6px}
        .period-btn{padding:6px 12px;border:1px solid #ddd;border-radius:6px;background:#fff;color:#333;font-size:14px;font-weight:500;cursor:pointer;transition:.2s}
        .period-btn:hover{border-color:#A68DC0;color:#A68DC0}
        .period-btn.active{background:#A68DC0;color:#fff;border-color:#A68DC0}

        @media(max-width:768px){
            .grid{grid-template-columns:1fr}
            .order-status{flex-direction:column;gap:16px}
            .order-step::after{display:none}
        }
    </style>
    <link rel="stylesheet" href="/css/header.css">
</head>
<body>
<div id="header"></div>
<div id="siteHeader"></div>
<div class="container">
    <div id="hero"></div>
    <div id="kpi"></div>
    <div class="grid">
        <div id="sidebar"></div>
        <div class="order-container">
            <h2>주문 내역</h2>
            <!-- 주문 단계 스텝 -->
            <div class="order-status">
                <div class="order-step">
                    <strong id="cntPending">0</strong>
                    <span>결제대기</span>
                </div>
                <div class="order-step">
                    <strong id="cntPaid">0</strong>
                    <span>결제완료</span>
                </div>
                <div class="order-step">
                    <strong id="cntProcessing">0</strong>
                    <span>상품 준비중</span>
                </div>
                <div class="order-step">
                    <strong id="cntShipping">0</strong>
                    <span>배송중</span>
                </div>
                <div class="order-step">
                    <strong id="cntDelivered">0</strong>
                    <span>배송완료</span>
                </div>
            </div>

            <!-- 기간 선택 영역 -->
            <div class="filter">
                <div class="period-buttons">
                    <button class="period-btn active" data-months="3">3개월</button>
                    <button class="period-btn" data-months="6">6개월</button>
                    <button class="period-btn" data-months="12">1년</button>
                </div>
            </div>

            <div id="orderList"></div>
            <div id="pagination" class="pagination"></div>
        </div>
    </div>
    <div id="mpAlert" class="muted mt16"></div>
</div>
<script src="/js/header.js"></script>
<script src="/js/fragment-loader.js"></script>
<script src="/js/mypage/mypage.js"></script>
<script src="/js/mypage/myorders.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const periodBtns = document.querySelectorAll(".period-btn");

        function refreshAll(months) {
            loadRecentOrdersStatus(months); // 전체 카운트
            loadOrders(0, months);          // 목록 (페이징)
        }

        refreshAll(12);

        periodBtns.forEach(btn => {
            btn.addEventListener("click", () => {
                periodBtns.forEach(b => b.classList.remove("active"));
                btn.classList.add("active");
                const months = parseInt(btn.dataset.months, 10);
                refreshAll(months);
            });
        });
    });

</script>
</body>
</html>