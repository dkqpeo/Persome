<div th:fragment="header">
    <header class="site-header" th:fragment="header">
        <div class="top-nav">
            <!-- ë¡œê·¸ì¸ X -->
            <span th:if="${#authentication == null or #authentication.name == 'anonymousUser'}">
                <a href="/users/terms">íšŒì›ê°€ì…</a> |
                <a href="/users/login">ë¡œê·¸ì¸</a>
            </span>

            <!-- ë¡œê·¸ì¸ O -->
            <span th:if="${#authentication != null and #authentication.authenticated and #authentication.name != 'anonymousUser'}">
                <span th:text="${#authentication.principal.displayName}"></span>
                    | <a href="/users/logout">ë¡œê·¸ì•„ì›ƒ</a>
                    | <a href="/mypage/">ë§ˆì´í˜ì´ì§€</a>
            </span>

            | <a href="/cart/">
                ì¥ë°”êµ¬ë‹ˆ
                <span th:if="${#authentication != null and #authentication.authenticated and #authentication.name != 'anonymousUser'}">
                    (<span id="cartCount">0</span>)
                </span>
            </a>

            | <a href="/orders">ì£¼ë¬¸ë°°ì†¡</a>
            | <a href="/help">ê³ ê°ì„¼í„°</a>
        </div>

        <div class="header-main">
            <!-- ë¡œê³  -->
            <div class="logo">
                <h1><a href="/">
                    PERS<span class="logo-o">O</span>ME</a></h1>
            </div>

            <!-- ê²€ìƒ‰ì°½ -->
            <div class="search-box">
                <form action="/search" method="get">
                    <input type="text" name="q" placeholder="ìƒí’ˆ, ë¸Œëœë“œ, ì„±ë¶„ ê²€ìƒ‰">
                    <button type="submit">ğŸ”</button>
                </form>
            </div>

            <!-- ì•„ì´ì½˜ ìë¦¬ (ì¶”í›„ ì¥ë°”êµ¬ë‹ˆ, ì•Œë¦¼ ì•„ì´ì½˜ ë“± ë„£ì„ ìˆ˜ ìˆìŒ) -->
            <div class="header-icons">
                <!-- í•„ìš”ì‹œ ì•„ì´ì½˜ ë„£ê¸° -->
            </div>
        </div>

        <nav class="main-nav">
            <ul>
                <li><a href="/category">ì¹´í…Œê³ ë¦¬</a></li>
                <li><a href="/special">ì˜¤íŠ¹</a></li>
                <li><a href="/ranking">ë­í‚¹</a></li>
                <li><a href="/health">í—¬ìŠ¤+</a></li>
                <li><a href="/luxe">LUXE EDIT</a></li>
                <li><a href="/events">ê¸°íšì „</a></li>
                <li><a href="/sale">ì„¸ì¼</a></li>
                <li><a href="/gift">ê¸°í”„íŠ¸ì¹´ë“œ</a></li>
                <li><a href="/membership">ë©¤ë²„ì‹­/ì¿ í°</a></li>
                <li><a href="/event">ì´ë²¤íŠ¸</a></li>
            </ul>
        </nav>
    </header>

    <style>
        /* í—¤ë” ì „ì²´ */
        .site-header {
            border-bottom: 1px solid #eee;
            padding: 5px 20px;
            font-size: 0.9em;
            font-family: "Noto Sans KR", Arial, sans-serif;
        }

        /* ìƒë‹¨ ë„¤ë¹„ */
        .top-nav {
            text-align: right;
            font-size: 0.85em;
            color: #555;
            margin-bottom: 10px;
        }

        .top-nav a {
            margin: 0 5px;
            text-decoration: none;
            color: #555;
        }

        .header-main {
            position: relative;
            height: 60px; /* ë†’ì´ ê³ ì • */
            margin-bottom: 25px;
        }

        /* ë¡œê³ ëŠ” ì™¼ìª½ */
        .logo {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        .logo h1 a {
            text-decoration: none;
            color: #4C3579;
            font-weight: bold;
            font-size: 2em;
        }

        .logo h1 .logo-o {
            color: #B4A0E0;
        }

        /* ê²€ìƒ‰ì°½ì€ í™”ë©´ ê¸°ì¤€ ì •í™•íˆ ì¤‘ì•™ */
        .search-box {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%); /* X, Y ë‘˜ ë‹¤ ì •ì¤‘ì•™ */
        }

        .search-box form {
            display: flex;
            align-items: center;
            border: 2px solid #A68DC0;
            border-radius: 20px;
            padding: 2px 8px;
            width: 350px;
            height: 34px;
            position: relative;
        }

        .search-box input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 0.9em;
            padding: 0 35px 0 10px; /* ì˜¤ë¥¸ìª½ì— ë²„íŠ¼ ê³µê°„ í™•ë³´ */
            height: 100%;
            box-sizing: border-box;
        }

        .search-box button {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            border: none;
            background: none;
            cursor: pointer;
            padding: 0; /* ë¶ˆí•„ìš”í•œ padding ì œê±° */
            margin: 0;
            width: 18px; /* ì•„ì´ì½˜ í¬ê¸°ë§Œí¼ë§Œ ì°¨ì§€ */
            height: 18px;
            font-size: 16px;
            line-height: 1;
            color: #666;
        }

        /* ì•„ì´ì½˜ì€ ì˜¤ë¥¸ìª½ */
        .header-icons {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        /* í•˜ë‹¨ ë„¤ë¹„ ë©”ë‰´ */
        .main-nav ul {
            list-style: none;
            padding: 0;
            display: flex;
            justify-content: space-around;
            font-weight: bold;
            margin-top: 10px;
        }

        .main-nav li a {
            text-decoration: none;
            color: #222;
            padding: 10px 15px;
        }

        .main-nav li a:hover { color: #A68DC0; }
    </style>
    <script src="/js/app.js"></script>
    <!-- ë¡œê·¸ì¸ ì‹œ í˜„ì¬ ì‚¬ìš©ì ì •ë³´ë¥¼ ì „ì—­ìœ¼ë¡œ ë…¸ì¶œ (Thymeleaf inline JS í•„ìš”) -->
    <script th:if="${#authentication != null and #authentication.authenticated and #authentication.name != 'anonymousUser'}" th:inline="javascript">
        window.PersomeUser = {
            id: [[${#authentication.principal.id}]],
            loginId: /*[[${#authentication.name}]]*/
        };
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Persome && typeof window.Persome.updateHeaderCartCount === 'function') {
                window.Persome.updateHeaderCartCount().catch(() => {});
            }
        });
    </script>
</div>
